'use strict';
var path = require('path');
var assert = require('assert');
var Model = require('./model').default;
var Service = require('./service').default;
/**
 * TODO - Describe what your controller does.
 *
 * @class         Passes
 * @module        Passes
 * @constructor
 */
var service;
var PassesController = (function () {
    function PassesController(options) {
        console.log('PassesController Constructor');
        service = new Service();
    }
    PassesController.prototype.use = function (req, res, next) {
        console.log('Passes.use', req.method, req.url, req.params);
        next();
    };
    PassesController.prototype.all = function (req, res, next) {
        if (req.params.id) {
            req.id = req.params.id;
            console.log('Got id', req.id);
        }
        console.log('PassesController-controller.all', req.method, req.url);
        next();
    };
    PassesController.prototype.index = function (req, res, next) {
        next();
    };
    PassesController.prototype.get_route = function (req, res, next) {
        if (req.id) {
            service.get(req.id).then(function (resp) {
                res.status(200).send(resp);
            }).catch(function (err) {
                res.status(404).send(err);
            });
        }
        else {
            service.find(req.params).then(function (resp) {
                res.status(200).send(resp);
            }).catch(function (err) {
                res.status(404).send(err);
            });
        }
    };
    PassesController.prototype.post_route = function (req, res, next) {
        var m = new Model(req.body);
        console.log('creating', m);
        service.save(m).then(function (resp) {
            res.status(201).send(resp);
        }).catch(function (err) {
            res.status(404).send(err);
        });
    };
    PassesController.prototype.put_route = function (req, res, next) {
        var model = new Model(req.body);
        console.log('updating', req.params.id);
        service.save(model).then(function (resp) {
            res.status(200).send(resp);
        }).catch(function (err) {
            res.status(404).send(err);
        });
    };
    PassesController.prototype.delete_route = function (req, res, next) {
        assert(req.params.id, 'has id');
        console.log('removing', req.params.id);
        service.remove(req.params.id).then(function (resp) {
            res.status(200).send(resp);
        }).catch(function (err) {
            res.status(404).send(err);
        });
    };
    return PassesController;
})();
exports["default"] = PassesController;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsdWdpbnMvcGFzc2VzL2NvbnRyb2xsZXIudHMiXSwibmFtZXMiOlsiUGFzc2VzQ29udHJvbGxlciIsIlBhc3Nlc0NvbnRyb2xsZXIuY29uc3RydWN0b3IiLCJQYXNzZXNDb250cm9sbGVyLnVzZSIsIlBhc3Nlc0NvbnRyb2xsZXIuYWxsIiwiUGFzc2VzQ29udHJvbGxlci5pbmRleCIsIlBhc3Nlc0NvbnRyb2xsZXIuZ2V0X3JvdXRlIiwiUGFzc2VzQ29udHJvbGxlci5wb3N0X3JvdXRlIiwiUGFzc2VzQ29udHJvbGxlci5wdXRfcm91dGUiLCJQYXNzZXNDb250cm9sbGVyLmRlbGV0ZV9yb3V0ZSJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDO0FBQ2IsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzdCLElBQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNqQyxJQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTyxDQUFDO0FBQ3pDLElBQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFFN0M7Ozs7OztHQU1HO0FBQ0gsSUFBSSxPQUFPLENBQUM7QUFDWjtJQU1JQSwwQkFBWUEsT0FBV0E7UUFDbkJDLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLDhCQUE4QkEsQ0FBQ0EsQ0FBQ0E7UUFDNUNBLE9BQU9BLEdBQUdBLElBQUlBLE9BQU9BLEVBQUVBLENBQUNBO0lBQzVCQSxDQUFDQTtJQUVERCw4QkFBR0EsR0FBSEEsVUFBSUEsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsSUFBSUE7UUFDZEUsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsWUFBWUEsRUFBRUEsR0FBR0EsQ0FBQ0EsTUFBTUEsRUFBRUEsR0FBR0EsQ0FBQ0EsR0FBR0EsRUFBRUEsR0FBR0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7UUFDM0RBLElBQUlBLEVBQUVBLENBQUNBO0lBQ1hBLENBQUNBO0lBRURGLDhCQUFHQSxHQUFIQSxVQUFJQSxHQUFHQSxFQUFFQSxHQUFHQSxFQUFFQSxJQUFJQTtRQUNkRyxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNoQkEsR0FBR0EsQ0FBQ0EsRUFBRUEsR0FBR0EsR0FBR0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsRUFBRUEsQ0FBQ0E7WUFDdkJBLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLFFBQVFBLEVBQUVBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBO1FBQ2xDQSxDQUFDQTtRQUNEQSxPQUFPQSxDQUFDQSxHQUFHQSxDQUFDQSxpQ0FBaUNBLEVBQUVBLEdBQUdBLENBQUNBLE1BQU1BLEVBQUVBLEdBQUdBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ3BFQSxJQUFJQSxFQUFFQSxDQUFDQTtJQUNYQSxDQUFDQTtJQUVESCxnQ0FBS0EsR0FBTEEsVUFBTUEsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsSUFBSUE7UUFDaEJJLElBQUlBLEVBQUVBLENBQUNBO0lBQ1hBLENBQUNBO0lBRURKLG9DQUFTQSxHQUFUQSxVQUFVQSxHQUFHQSxFQUFFQSxHQUFHQSxFQUFFQSxJQUFJQTtRQUNwQkssRUFBRUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDVEEsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBQ0EsSUFBSUE7Z0JBQzFCQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUMvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsVUFBQ0EsR0FBR0E7Z0JBQ1RBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1lBQzlCQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNQQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNKQSxPQUFPQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFDQSxJQUFJQTtnQkFDL0JBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQy9CQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxVQUFDQSxHQUFHQTtnQkFDVEEsR0FBR0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDOUJBLENBQUNBLENBQUNBLENBQUNBO1FBQ1BBLENBQUNBO0lBQ0xBLENBQUNBO0lBRURMLHFDQUFVQSxHQUFWQSxVQUFXQSxHQUFHQSxFQUFFQSxHQUFHQSxFQUFFQSxJQUFJQTtRQUNyQk0sSUFBSUEsQ0FBQ0EsR0FBR0EsSUFBSUEsS0FBS0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDNUJBLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLFVBQVVBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO1FBRTNCQSxPQUFPQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFDQSxJQUFJQTtZQUN0QkEsR0FBR0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDL0JBLENBQUNBLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLFVBQUNBLEdBQUdBO1lBQ1RBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQzlCQSxDQUFDQSxDQUFDQSxDQUFBQTtJQUNOQSxDQUFDQTtJQUVETixvQ0FBU0EsR0FBVEEsVUFBVUEsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsSUFBSUE7UUFDcEJPLElBQUlBLEtBQUtBLEdBQUdBLElBQUlBLEtBQUtBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1FBQ2hDQSxPQUFPQSxDQUFDQSxHQUFHQSxDQUFDQSxVQUFVQSxFQUFFQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQTtRQUV2Q0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBQ0EsSUFBSUE7WUFDMUJBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1FBQy9CQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxVQUFDQSxHQUFHQTtZQUNUQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtRQUM5QkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFDUEEsQ0FBQ0E7SUFFRFAsdUNBQVlBLEdBQVpBLFVBQWFBLEdBQUdBLEVBQUVBLEdBQUdBLEVBQUVBLElBQUlBO1FBQ3ZCUSxNQUFNQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQSxFQUFFQSxFQUFFQSxRQUFRQSxDQUFDQSxDQUFDQTtRQUNoQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsVUFBVUEsRUFBRUEsR0FBR0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0E7UUFFdkNBLE9BQU9BLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFVBQUNBLElBQUlBO1lBQ3BDQSxHQUFHQSxDQUFDQSxNQUFNQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUMvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsVUFBQ0EsR0FBR0E7WUFDVEEsR0FBR0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDOUJBLENBQUNBLENBQUNBLENBQUNBO0lBQ1BBLENBQUNBO0lBQ0xSLHVCQUFDQTtBQUFEQSxDQTdFQSxBQTZFQ0EsSUFBQTtBQTdFRCxxQ0E2RUMsQ0FBQSIsImZpbGUiOiJwbHVnaW5zL3Bhc3Nlcy9jb250cm9sbGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IGFzc2VydCA9IHJlcXVpcmUoJ2Fzc2VydCcpO1xuY29uc3QgTW9kZWwgPSByZXF1aXJlKCcuL21vZGVsJykuZGVmYXVsdDtcbmNvbnN0IFNlcnZpY2UgPSByZXF1aXJlKCcuL3NlcnZpY2UnKS5kZWZhdWx0O1xuXG4vKipcbiAqIFRPRE8gLSBEZXNjcmliZSB3aGF0IHlvdXIgY29udHJvbGxlciBkb2VzLlxuICpcbiAqIEBjbGFzcyAgICAgICAgIFBhc3Nlc1xuICogQG1vZHVsZSAgICAgICAgUGFzc2VzXG4gKiBAY29uc3RydWN0b3JcbiAqL1xubGV0IHNlcnZpY2U7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYXNzZXNDb250cm9sbGVyIHtcblxuICAgIC8vc2VydmljZTpTZXJ2aWNlO1xuICAgIG1vZGVsOk1vZGVsO1xuICAgIGNvbGxlY3Rpb246YW55O1xuXG4gICAgY29uc3RydWN0b3Iob3B0aW9uczphbnkpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1Bhc3Nlc0NvbnRyb2xsZXIgQ29uc3RydWN0b3InKTtcbiAgICAgICAgc2VydmljZSA9IG5ldyBTZXJ2aWNlKCk7XG4gICAgfVxuXG4gICAgdXNlKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdQYXNzZXMudXNlJywgcmVxLm1ldGhvZCwgcmVxLnVybCwgcmVxLnBhcmFtcyk7XG4gICAgICAgIG5leHQoKTtcbiAgICB9XG5cbiAgICBhbGwocmVxLCByZXMsIG5leHQpIHtcbiAgICAgICAgaWYgKHJlcS5wYXJhbXMuaWQpIHtcbiAgICAgICAgICAgIHJlcS5pZCA9IHJlcS5wYXJhbXMuaWQ7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnR290IGlkJywgcmVxLmlkKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygnUGFzc2VzQ29udHJvbGxlci1jb250cm9sbGVyLmFsbCcsIHJlcS5tZXRob2QsIHJlcS51cmwpO1xuICAgICAgICBuZXh0KCk7XG4gICAgfVxuXG4gICAgaW5kZXgocmVxLCByZXMsIG5leHQpIHtcbiAgICAgICAgbmV4dCgpO1xuICAgIH1cblxuICAgIGdldF9yb3V0ZShyZXEsIHJlcywgbmV4dCkge1xuICAgICAgICBpZiAocmVxLmlkKSB7XG4gICAgICAgICAgICBzZXJ2aWNlLmdldChyZXEuaWQpLnRoZW4oKHJlc3ApID0+IHtcbiAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChyZXNwKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDQwNCkuc2VuZChlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXJ2aWNlLmZpbmQocmVxLnBhcmFtcykudGhlbigocmVzcCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHJlc3ApO1xuICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoNDA0KS5zZW5kKGVycik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHBvc3Rfcm91dGUocmVxLCByZXMsIG5leHQpIHtcbiAgICAgICAgbGV0IG0gPSBuZXcgTW9kZWwocmVxLmJvZHkpO1xuICAgICAgICBjb25zb2xlLmxvZygnY3JlYXRpbmcnLCBtKTtcblxuICAgICAgICBzZXJ2aWNlLnNhdmUobSkudGhlbigocmVzcCkgPT4ge1xuICAgICAgICAgICAgcmVzLnN0YXR1cygyMDEpLnNlbmQocmVzcCk7XG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDA0KS5zZW5kKGVycik7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHV0X3JvdXRlKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgICAgIHZhciBtb2RlbCA9IG5ldyBNb2RlbChyZXEuYm9keSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd1cGRhdGluZycsIHJlcS5wYXJhbXMuaWQpO1xuXG4gICAgICAgIHNlcnZpY2Uuc2F2ZShtb2RlbCkudGhlbigocmVzcCkgPT4ge1xuICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQocmVzcCk7XG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDA0KS5zZW5kKGVycik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRlbGV0ZV9yb3V0ZShyZXEsIHJlcywgbmV4dCkge1xuICAgICAgICBhc3NlcnQocmVxLnBhcmFtcy5pZCwgJ2hhcyBpZCcpO1xuICAgICAgICBjb25zb2xlLmxvZygncmVtb3ZpbmcnLCByZXEucGFyYW1zLmlkKTtcblxuICAgICAgICBzZXJ2aWNlLnJlbW92ZShyZXEucGFyYW1zLmlkKS50aGVuKChyZXNwKSA9PiB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChyZXNwKTtcbiAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgcmVzLnN0YXR1cyg0MDQpLnNlbmQoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
